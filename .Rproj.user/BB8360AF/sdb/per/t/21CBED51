{
    "collab_server" : "",
    "contents" : "-- Reginald Edwards\n-- 12 June 2018\n--\n-- PostgresQL\n-- run in postgresql via \"\\include code/get-fundamentals.sql\"\n\n\n-- drop view v1;\n-- drop table firm_quarters;\n-- drop table long_firm_quarters;\n-- drop table long_firms;\n-- drop table fundq_short;\n\ncreate view v1 as select * \nfrom import.comp_fundq \nwhere indfmt = 'INDL' \n  and datafmt = 'STD'\n  and popsrc = 'D'\n  and consol = 'C'\n  and finalq = 'Y';\n\n-- create table firm_quarters as select gvkey, count(*) as nquarters from v1 group by gvkey;\n-- create table long_firm_quarters as select * from firm_quarters where nquarters >= 40;\n-- create table long_firms as select a.*, b.nquarters from import.comp_fundq as a, long_firm_quarters as b \n-- where a.gvkey = b.gvkey order by nquarters desc;\n\n-- get relevant ratio variables\ncreate table fundq_short as\nselect gvkey, fyr, fyearq, datacqtr, datadate, tic, conm,\napq,\najexq,\natq,\ncapxy,\ncheq,\ncshoq,\nceqq,\ncogsq,\nactq,\nlctq,\ndlcq,\ntxdbq,\ntxditcq,\ndpcy,\ndpq,\ndvpq,\ndvpy,\noepsxy,\nepspxq,\nepsfxq,\nepsfiq,\nopepsq,\nxidoq,\nibq,\nibadjq,\nibcomq,\nibcy,\ntxtq,\ntxpq,\nxintq,\ninvtq,\nicaptq,\nltq,\ndlttq,\nniq,\nmiiq,\nmibq,\nnopiq,\noancfy,\nxoprq,\noiadpq,\noibdpq,\npstkrq,\npstkq,\npiq,\nprccq,\nppentq,\nrectq,\nxrdq,\nrevtq,\nsaleq,\nxsgaq,\nspiq,\nseqq\nfrom v1\norder by gvkey, datacqtr;\n-- 1,541,162",
    "created" : 1528937767423.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1286616821",
    "id" : "21CBED51",
    "lastKnownWriteTime" : 1529178006,
    "last_content_update" : 1529178006779,
    "path" : "C:/Users/Reginald/Dropbox/Research/earnings/code/get-fundamentals.sql",
    "project_path" : "code/get-fundamentals.sql",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "sql"
}