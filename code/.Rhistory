if(current.firm$nyears[1]>14){
current.firm.train <- current.firm[which(current.firm$fyear < max(current.firm$fyear)), ]
current.firm.test <- current.firm[which(current.firm$fyear == max(current.firm$fyear)), ]
## Exclude firms whose firms are negative over the entire observation period
if(!all(is.na(current.firm$pe))){
m.actual_lag1 <- tryCatch(lm(actual ~ actual_lag1, data=current.firm.train)$r.squared[["actual_lag1"]], error = function(e) NA)
m.totalassets <- tryCatch(lm(actual ~ actual_lag1 + totalassets_lag1, data=current.firm.train)$r.squared[["totalassets_lag1"]], error = function(e) NA)
m.logtotalassets <- tryCatch(lm(actual ~ actual_lag1 + logtotalassets_lag1, data=current.firm.train)$r.squared[["logtotalassets_lag1"]], error = function(e) NA)
m.acc <- tryCatch(lm(actual ~ actual_lag1 + acc_lag1, data=current.firm.train)$r.squared[["acc_lag1"]], error = function(e) NA)
m.dividends <- tryCatch(lm(actual ~ actual_lag1 + dividends_lag1, data=current.firm.train)$r.squared[["dividends_lag1"]], error = function(e) NA)
m.neg_actual <- tryCatch(lm(actual ~ actual_lag1 + neg_actual_lag1, data=current.firm.train)$r.squared[["neg_actual_lag1"]], error = function(e) NA)
m.stockprcchg <- tryCatch(lm(actual ~ actual_lag1 + stockprcchg, data=current.firm.train)$r.squared[["stockprcchg"]], error = function(e) NA)
m.stockret <- tryCatch(lm(actual ~ actual_lag1 + stockret_lag1, data=current.firm.train)$r.squared[["stockret_lag1"]], error = function(e) NA)
m.gdp <- tryCatch(lm(actual ~ actual_lag1 + gdp_pc1, data=current.firm.train)$r.squared[["gdp_pc1" ]], error=function(e) NA)
m.roe <- tryCatch(lm(actual ~ actual_lag1 + roe_lag1, data=current.firm.train)$r.squared[["roe_lag1"]], error = function(e) NA)
m.unemployment <- tryCatch(lm(actual ~ actual_lag1 + unemployment, data=current.firm.train)$r.squared[["unemployment"]], error = function(e) NA)
m.ppi <- tryCatch(lm(actual ~ actual_lag1 + ppipct, data=current.firm.train)$r.squared[["ppipct"]], error = function(e) NA)
m.pe <- tryCatch(lm(actual ~ actual_lag1 + pe_lag1, data=current.firm.train)$r.squared[["pe_lag1"]], error = function(e) NA)
m.sale <- tryCatch(lm(actual ~ actual_lag1 + logsale_lag1, data=current.firm.train)$r.squared[["logsale_lag1"]], error = function(e) NA)
m.rect <- tryCatch(lm(actual ~ actual_lag1 + logrect_lag1, data=current.firm.train)$r.squared[["logrect_lag1"]], error = function(e) NA)
m.ap <- tryCatch(lm(actual ~ actual_lag1 + logap_lag1, data=current.firm.train)$r.squared[["logap_lag1"]], error = function(e) NA)
m.chgsale <- tryCatch(lm(actual ~ actual_lag1 + chgsale_lag1, data=current.firm.train)$r.squared[["chgsale_lag1"]], error = function(e) NA)
m.chgrect <- tryCatch(lm(actual ~ actual_lag1 + chgrect_lag1, data=current.firm.train)$r.squared[["chgrect_lag1"]], error = function(e) NA)
m.chgap <- tryCatch(lm(actual ~ actual_lag1 + chgap_lag1, data=current.firm.train)$r.squared[["chgap_lag1"]], error = function(e) NA)
}
univariate.rsquared[current.ticker, c("actual_lag1",
"totalassets_lag1",
"logtotalassets_lag1",
"acc_lag1",
"dividends_lag1",
"neg_actual_lag1",
"stockprcchg",
"stockret_lag1",
"gdp_pc1",
"roe_lag1",
"unemployment",
"ppipct",
"logsale_lag1",
"logrect_lag1",
"logap_lag1",
"chgsale_lag1",
"chgrect_lag1",
"chgap_lag1",
"pe_lag1")] <- c(m.actual_lag1, m.totalassets, m.logtotalassets, m.acc, m.dividends,
m.neg_actual, m.stockprcchg, m.stockret, m.gdp, m.roe,
m.unemployment, m.ppi, m.sale, m.rect, m.ap, m.chgsale, m.chgrect, m.chgap, m.pe)
}
i <- i+1
}
current.ticker <- firms[i]
current.firm <- X[which(X$tic==current.ticker), ]
current.firm.train <- current.firm[which(current.firm$fyear < max(current.firm$fyear)), ]
current.firm.test <- current.firm[which(current.firm$fyear == max(current.firm$fyear)), ]
m.actual_lag1 <- tryCatch(lm(actual ~ actual_lag1, data=current.firm.train)$r.squared[["actual_lag1"]], error = function(e) NA)
lm(actual ~ actual_lag1, data=current.firm.train)
lm(actual ~ actual_lag1, data=current.firm.train)$r.squared[["actual_lag1"]]
m <- lm(actual ~ actual_lag1, data=current.firm.train)
m$rsq
m$r.sq
m$r.squared
m
summary(m)$r.squared
m.actual_lag1 <- tryCatch(summary(lm(actual ~ actual_lag1, data=current.firm.train))$r.squared[["actual_lag1"]], error = function(e) NA)
summary(lm(actual ~ actual_lag1, data=current.firm.train))$r.squared[["actual_lag1"]]
m.actual_lag1 <- tryCatch(summary(lm(actual ~ actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.actual_lag1 <- tryCatch(summary(lm(actual ~ actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.totalassets <- tryCatch(summary(lm(actual ~ actual_lag1 + totalassets_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.logtotalassets <- tryCatch(summary(lm(actual ~ actual_lag1 + logtotalassets_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.acc <- tryCatch(summary(lm(actual ~ actual_lag1 + acc_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.dividends <- tryCatch(summary(lm(actual ~ actual_lag1 + dividends_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.neg_actual <- tryCatch(summary(lm(actual ~ actual_lag1 + neg_actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.stockprcchg <- tryCatch(summary(lm(actual ~ actual_lag1 + stockprcchg, data=current.firm.train))$r.squared, error = function(e) NA)
m.stockret <- tryCatch(summary(lm(actual ~ actual_lag1 + stockret_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.gdp <- tryCatch(summary(lm(actual ~ actual_lag1 + gdp_pc1, data=current.firm.train))$r.squared, error=function(e) NA)
m.roe <- tryCatch(summary(lm(actual ~ actual_lag1 + roe_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.unemployment <- tryCatch(summary(lm(actual ~ actual_lag1 + unemployment, data=current.firm.train))$r.squared, error = function(e) NA)
m.ppi <- tryCatch(summary(lm(actual ~ actual_lag1 + ppipct, data=current.firm.train))$r.squared, error = function(e) NA)
m.pe <- tryCatch(summary(lm(actual ~ actual_lag1 + pe_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.sale <- tryCatch(summary(lm(actual ~ actual_lag1 + logsale_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.rect <- tryCatch(summary(lm(actual ~ actual_lag1 + logrect_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.ap <- tryCatch(summary(lm(actual ~ actual_lag1 + logap_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgsale <- tryCatch(summary(lm(actual ~ actual_lag1 + chgsale_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgrect <- tryCatch(summary(lm(actual ~ actual_lag1 + chgrect_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgap <- tryCatch(summary(lm(actual ~ actual_lag1 + chgap_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
###################################################################################################
# Bivariate R-squared
###################################################################################################
univariate.rsquared <- data.frame(matrix(NA, nrow=0, ncol=length(indep.variables)))
names(univariate.rsquared) <- indep.variables
i <- 1
while(i <= n.firms){
current.ticker <- firms[i]
current.firm <- X[which(X$tic==current.ticker), ]
if(current.firm$nyears[1]>14){
current.firm.train <- current.firm[which(current.firm$fyear < max(current.firm$fyear)), ]
current.firm.test <- current.firm[which(current.firm$fyear == max(current.firm$fyear)), ]
## Exclude firms whose firms are negative over the entire observation period
if(!all(is.na(current.firm$pe))){
m.actual_lag1 <- tryCatch(summary(lm(actual ~ actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.totalassets <- tryCatch(summary(lm(actual ~ actual_lag1 + totalassets_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.logtotalassets <- tryCatch(summary(lm(actual ~ actual_lag1 + logtotalassets_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.acc <- tryCatch(summary(lm(actual ~ actual_lag1 + acc_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.dividends <- tryCatch(summary(lm(actual ~ actual_lag1 + dividends_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.neg_actual <- tryCatch(summary(lm(actual ~ actual_lag1 + neg_actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.stockprcchg <- tryCatch(summary(lm(actual ~ actual_lag1 + stockprcchg, data=current.firm.train))$r.squared, error = function(e) NA)
m.stockret <- tryCatch(summary(lm(actual ~ actual_lag1 + stockret_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.gdp <- tryCatch(summary(lm(actual ~ actual_lag1 + gdp_pc1, data=current.firm.train))$r.squared, error=function(e) NA)
m.roe <- tryCatch(summary(lm(actual ~ actual_lag1 + roe_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.unemployment <- tryCatch(summary(lm(actual ~ actual_lag1 + unemployment, data=current.firm.train))$r.squared, error = function(e) NA)
m.ppi <- tryCatch(summary(lm(actual ~ actual_lag1 + ppipct, data=current.firm.train))$r.squared, error = function(e) NA)
m.pe <- tryCatch(summary(lm(actual ~ actual_lag1 + pe_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.sale <- tryCatch(summary(lm(actual ~ actual_lag1 + logsale_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.rect <- tryCatch(summary(lm(actual ~ actual_lag1 + logrect_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.ap <- tryCatch(summary(lm(actual ~ actual_lag1 + logap_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgsale <- tryCatch(summary(lm(actual ~ actual_lag1 + chgsale_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgrect <- tryCatch(summary(lm(actual ~ actual_lag1 + chgrect_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgap <- tryCatch(summary(lm(actual ~ actual_lag1 + chgap_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
}
univariate.rsquared[current.ticker, c("actual_lag1",
"totalassets_lag1",
"logtotalassets_lag1",
"acc_lag1",
"dividends_lag1",
"neg_actual_lag1",
"stockprcchg",
"stockret_lag1",
"gdp_pc1",
"roe_lag1",
"unemployment",
"ppipct",
"logsale_lag1",
"logrect_lag1",
"logap_lag1",
"chgsale_lag1",
"chgrect_lag1",
"chgap_lag1",
"pe_lag1")] <- c(m.actual_lag1, m.totalassets, m.logtotalassets, m.acc, m.dividends,
m.neg_actual, m.stockprcchg, m.stockret, m.gdp, m.roe,
m.unemployment, m.ppi, m.sale, m.rect, m.ap, m.chgsale, m.chgrect, m.chgap, m.pe)
}
i <- i+1
}
###################################################################################################
## Create summary stats of univariate R-Squared
###################################################################################################
summary.stats <- data.frame(matrix(NA, nrow=0, ncol=5))
names(summary.stats) <- c("mean","med","min","max","stdev")
summary.stats["EPS_{t-1}", ] <- get.summary.stats(univariate.rsquared$actual_lag1)
summary.stats["Total Assets", ] <- get.summary.stats(univariate.rsquared$totalassets_lag1)
summary.stats["Log Assets", ] <- get.summary.stats(univariate.rsquared$logtotalassets_lag1)
summary.stats["Accruals", ] <- get.summary.stats(univariate.rsquared$acc_lag1)
summary.stats["Dividends", ] <- get.summary.stats(univariate.rsquared$dividends_lag1)
summary.stats["Negative Earnings", ] <- get.summary.stats(univariate.rsquared$neg_actual_lag1)
summary.stats["Delta Price", ] <- get.summary.stats(univariate.rsquared$stockprcchg)
summary.stats["return", ] <- get.summary.stats(univariate.rsquared$stockret_lag1)
summary.stats["PE Ratio", ] <- get.summary.stats(univariate.rsquared$pe_lag1)
summary.stats["GDP", ] <- get.summary.stats(univariate.rsquared$gdp_pc1)
summary.stats["ROE", ] <- get.summary.stats(univariate.rsquared$roe_lag1)
summary.stats["Unemployment", ] <- get.summary.stats(univariate.rsquared$unemployment)
summary.stats["Inflation (PPI)", ] <- get.summary.stats(univariate.rsquared$ppipct)
summary.stats["Sales", ] <- get.summary.stats(univariate.rsquared$logsale_lag1)
summary.stats["AR", ] <- get.summary.stats(univariate.rsquared$logrect_lag1)
summary.stats["AP", ] <- get.summary.stats(univariate.rsquared$logap_lag1)
summary.stats["Delta Sales", ] <- get.summary.stats(univariate.rsquared$chgsale_lag1)
summary.stats["Delta AR", ] <- get.summary.stats(univariate.rsquared$chgrect_lag1)
summary.stats["Delta AP", ] <- get.summary.stats(univariate.rsquared$chgap_lag1)
summary.stats.xtable <- xtable(summary.stats, digits=4, caption=".", label="univariate-stats-eps-rsquared")
print(summary.stats.xtable, type="latex", file="../tables/univariate-stats-eps-rsquared.tex")
summary.stats <- data.frame(matrix(NA, nrow=0, ncol=5))
names(summary.stats) <- c("mean","med","min","max","stdev")
summary.stats["EPS", ] <- get.summary.stats(X$actual)
summary.stats["EPS Growth", ] <- get.summary.stats(X$epsgrowth)
summary.stats["Total Assets", ] <- get.summary.stats(X$totalassets_lag1)
summary.stats["Accruals", ] <- get.summary.stats(X$acc_lag1)
summary.stats["Dividends", ] <- get.summary.stats(X$dividends_lag1)
summary.stats["Dividend Payer", ] <- get.summary.stats(X$dividendpayer_lag1)
summary.stats["Negative Earnings", ] <- get.summary.stats(X$neg_actual_lag1)
summary.stats["Delta Price", ] <- get.summary.stats(X$stockprcchg)
summary.stats["return", ] <- get.summary.stats(X$stockret_lag1)
summary.stats["PE Ratio", ] <- get.summary.stats(X$pe_lag1)
summary.stats["GDP", ] <- get.summary.stats(X$gdp_pc1)
summary.stats["ROE", ] <- get.summary.stats(X$roe_lag1)
summary.stats["Unemployment", ] <- get.summary.stats(X$unemployment)
summary.stats["Inflation (PPI)", ] <- get.summary.stats(X$ppipct)
summary.stats["Sales", ] <- get.summary.stats(X$sale_lag1)
summary.stats["AR", ] <- get.summary.stats(X$rect_lag1)
summary.stats["AP", ] <- get.summary.stats(X$ap_lag1)
summary.stats["Age", ] <- get.summary.stats(X$nyears)
summary.stats["Delta Sales", ] <- get.summary.stats(X$chgsale_lag1)
summary.stats["Delta AR", ] <- get.summary.stats(X$chgrect_lag1)
summary.stats["Delta AP", ] <- get.summary.stats(X$chgap_lag1)
summary.stats["Age", ] <- get.summary.stats(X$nyears)
summary.stats.xtable <- xtable(summary.stats, digits=3, caption=".", label="summary-stats")
print(summary.stats.xtable, type="latex", file="..tables/summary-stats.tex")
print(summary.stats.xtable, type="latex", file="../tables/summary-stats.tex")
Limit to non-short firms
X <- X[which(X$nyears >= 10), ]
firms <- unique(as.character(X$tic))
n.firms <- length(firms)
X <- X[order(X$tic, X$fyear), ]
which(!all(is.na(current.firm$pe)))
which(!all(is.na(X$pe)))
which(all(is.na(X$pe)))
X <- X[-which(all(is.na(X$pe))), ]
X <- read.sas7bdat("../data/fy1_modeling.sas7bdat")
X.names <- names(X)
names(X) <- tolower(X.names)
length(unique(X$tic))
## Limit to non-short firms
X <- X[which(X$nyears >= 10), ]
## Exclude firms whose firms are negative over the entire observation period
X <- X[!which(all(is.na(X$pe))), ]
which(all(is.na(X$pe)))
rm(list=ls())
library(sas7bdat)
library(xtable)
X <- read.sas7bdat("../data/fy1_modeling.sas7bdat")
X.names <- names(X)
names(X) <- tolower(X.names)
length(unique(X$tic))
## Limit to non-short firms
X <- X[which(X$nyears >= 10), ]
## Exclude firms whose firms are negative over the entire observation period
## X <- X[!which(all(is.na(X$pe))), ]
firms <- unique(as.character(X$tic))
n.firms <- length(firms)
X <- X[order(X$tic, X$fyear), ]
indep.variables <- c("actual_lag1",
"totalassets_lag1",
"logtotalassets_lag1",
"acc_lag1",
"dividends_lag1",
"dividendpayer_lag1",
"epsgrowth_lag1",
"neg_actual_lag1",
"stockprcchg",
"gdp_pc1",
"unemployment",
"ppipct",
"pe_lag1",
"sale_lag1",
"ap_lag1",
"rect_lag1",
"logsale_lag1",
"logap_lag1",
"chgsale_lag1",
"chgap_lag1",
"chgrect_lag1",
"stockret_lag1")
ibes.variables <- c("meanest",
"medest",
"logrect_lag1",
"numest",
"stdev")
###################################################################################################
"roe_lag1",
indep.variables <- c("actual_lag1",
"totalassets_lag1",
"logtotalassets_lag1",
"acc_lag1",
"dividends_lag1",
"dividendpayer_lag1",
"epsgrowth_lag1",
"neg_actual_lag1",
"stockprcchg",
"gdp_pc1",
"roe_lag1",
"unemployment",
"ppipct",
"pe_lag1",
"sale_lag1",
"ap_lag1",
"rect_lag1",
"logsale_lag1",
"logap_lag1",
"logrect_lag1",
"chgsale_lag1",
"chgap_lag1",
"chgrect_lag1",
"stockret_lag1")
ibes.variables <- c("meanest",
"medest",
"numest",
"stdev")
###################################################################################################
# Summary Stats
###################################################################################################
## Functions
get.summary.stats <- function(x){
c(mean(x, na.rm=TRUE), median(x, na.rm=TRUE),
min(x, na.rm=TRUE), max(x, na.rm=TRUE), sd(x, na.rm=TRUE))
}
summary.stats <- data.frame(matrix(NA, nrow=0, ncol=5))
names(summary.stats) <- c("mean","med","min","max","stdev")
summary.stats["EPS", ] <- get.summary.stats(X$actual)
summary.stats["EPS Growth", ] <- get.summary.stats(X$epsgrowth)
summary.stats["Total Assets", ] <- get.summary.stats(X$totalassets_lag1)
summary.stats["Accruals", ] <- get.summary.stats(X$acc_lag1)
summary.stats["Dividends", ] <- get.summary.stats(X$dividends_lag1)
summary.stats["Dividend Payer", ] <- get.summary.stats(X$dividendpayer_lag1)
summary.stats["Negative Earnings", ] <- get.summary.stats(X$neg_actual_lag1)
summary.stats["Delta Price", ] <- get.summary.stats(X$stockprcchg)
summary.stats["return", ] <- get.summary.stats(X$stockret_lag1)
summary.stats["PE Ratio", ] <- get.summary.stats(X$pe_lag1)
summary.stats["GDP", ] <- get.summary.stats(X$gdp_pc1)
summary.stats["ROE", ] <- get.summary.stats(X$roe_lag1)
summary.stats["Unemployment", ] <- get.summary.stats(X$unemployment)
summary.stats["Inflation (PPI)", ] <- get.summary.stats(X$ppipct)
summary.stats["Sales", ] <- get.summary.stats(X$sale_lag1)
summary.stats["AR", ] <- get.summary.stats(X$rect_lag1)
summary.stats["AP", ] <- get.summary.stats(X$ap_lag1)
summary.stats["Age", ] <- get.summary.stats(X$nyears)
summary.stats["Delta Sales", ] <- get.summary.stats(X$chgsale_lag1)
summary.stats["Delta AR", ] <- get.summary.stats(X$chgrect_lag1)
summary.stats["Delta AP", ] <- get.summary.stats(X$chgap_lag1)
summary.stats["Age", ] <- get.summary.stats(X$nyears)
summary.stats.xtable <- xtable(summary.stats, digits=3, caption=".", label="summary-stats")
print(summary.stats.xtable, type="latex", file="../tables/summary-stats.tex")
###################################################################################################
# Bivariate analysis
###################################################################################################
univariate.coeffs <- data.frame(matrix(NA, nrow=0, ncol=length(indep.variables)))
names(univariate.coeffs) <- indep.variables
i <- 1
while(i <= n.firms){
current.ticker <- firms[i]
current.firm <- X[which(X$tic==current.ticker), ]
current.firm.train <- current.firm[which(current.firm$fyear < max(current.firm$fyear)), ]
current.firm.test <- current.firm[which(current.firm$fyear == max(current.firm$fyear)), ]
m.actual_lag1 <- tryCatch(lm(actual ~ actual_lag1, data=current.firm.train)$coeff[["actual_lag1"]], error = function(e) NA)
m.totalassets <- tryCatch(lm(actual ~ actual_lag1 + totalassets_lag1, data=current.firm.train)$coeff[["totalassets_lag1"]], error = function(e) NA)
m.logtotalassets <- tryCatch(lm(actual ~ actual_lag1 + logtotalassets_lag1, data=current.firm.train)$coeff[["logtotalassets_lag1"]], error = function(e) NA)
m.acc <- tryCatch(lm(actual ~ actual_lag1 + acc_lag1, data=current.firm.train)$coeff[["acc_lag1"]], error = function(e) NA)
m.dividends <- tryCatch(lm(actual ~ actual_lag1 + dividends_lag1, data=current.firm.train)$coeff[["dividends_lag1"]], error = function(e) NA)
m.neg_actual <- tryCatch(lm(actual ~ actual_lag1 + neg_actual_lag1, data=current.firm.train)$coeff[["neg_actual_lag1"]], error = function(e) NA)
m.stockprcchg <- tryCatch(lm(actual ~ actual_lag1 + stockprcchg, data=current.firm.train)$coeff[["stockprcchg"]], error = function(e) NA)
m.stockret <- tryCatch(lm(actual ~ actual_lag1 + stockret_lag1, data=current.firm.train)$coeff[["stockret_lag1"]], error = function(e) NA)
m.gdp <- tryCatch(lm(actual ~ actual_lag1 + gdp_pc1, data=current.firm.train)$coeff[["gdp_pc1" ]], error=function(e) NA)
m.roe <- tryCatch(lm(actual ~ actual_lag1 + roe_lag1, data=current.firm.train)$coeff[["roe_lag1"]], error = function(e) NA)
m.unemployment <- tryCatch(lm(actual ~ actual_lag1 + unemployment, data=current.firm.train)$coeff[["unemployment"]], error = function(e) NA)
m.ppi <- tryCatch(lm(actual ~ actual_lag1 + ppipct, data=current.firm.train)$coeff[["ppipct"]], error = function(e) NA)
m.pe <- tryCatch(lm(actual ~ actual_lag1 + pe_lag1, data=current.firm.train)$coeff[["pe_lag1"]], error = function(e) NA)
m.sale <- tryCatch(lm(actual ~ actual_lag1 + logsale_lag1, data=current.firm.train)$coeff[["logsale_lag1"]], error = function(e) NA)
m.rect <- tryCatch(lm(actual ~ actual_lag1 + logrect_lag1, data=current.firm.train)$coeff[["logrect_lag1"]], error = function(e) NA)
m.ap <- tryCatch(lm(actual ~ actual_lag1 + logap_lag1, data=current.firm.train)$coeff[["logap_lag1"]], error = function(e) NA)
m.chgsale <- tryCatch(lm(actual ~ actual_lag1 + chgsale_lag1, data=current.firm.train)$coeff[["chgsale_lag1"]], error = function(e) NA)
m.chgrect <- tryCatch(lm(actual ~ actual_lag1 + chgrect_lag1, data=current.firm.train)$coeff[["chgrect_lag1"]], error = function(e) NA)
m.chgap <- tryCatch(lm(actual ~ actual_lag1 + chgap_lag1, data=current.firm.train)$coeff[["chgap_lag1"]], error = function(e) NA)
univariate.coeffs[current.ticker, c("actual_lag1",
"totalassets_lag1",
"logtotalassets_lag1",
"acc_lag1",
"dividends_lag1",
"neg_actual_lag1",
"stockprcchg",
"stockret_lag1",
"gdp_pc1",
"roe_lag1",
"unemployment",
"ppipct",
"logsale_lag1",
"logrect_lag1",
"logap_lag1",
"chgsale_lag1",
"chgrect_lag1",
"chgap_lag1",
"pe_lag1")] <- c(m.actual_lag1,
m.totalassets,
m.logtotalassets,
m.acc,
m.dividends,
m.neg_actual,
m.stockprcchg,
m.stockret,
m.gdp,
m.roe,
m.unemployment,
m.ppi,
m.sale,
m.rect,
m.ap,
m.chgsale,
m.chgrect,
m.chgap,
m.pe)
i <- i+1
}
## Create summary stats of univariate coefficients
summary.stats <- data.frame(matrix(NA, nrow=0, ncol=5))
names(summary.stats) <- c("mean","med","min","max","stdev")
summary.stats["EPS_{t-1}", ] <- get.summary.stats(univariate.coeffs$actual_lag1)
summary.stats["Total Assets", ] <- get.summary.stats(univariate.coeffs$totalassets_lag1)
summary.stats["Log Assets", ] <- get.summary.stats(univariate.coeffs$logtotalassets_lag1)
summary.stats["Accruals", ] <- get.summary.stats(univariate.coeffs$acc_lag1)
summary.stats["Dividends", ] <- get.summary.stats(univariate.coeffs$dividends_lag1)
summary.stats["Negative Earnings", ] <- get.summary.stats(univariate.coeffs$neg_actual_lag1)
summary.stats["Delta Price", ] <- get.summary.stats(univariate.coeffs$stockprcchg)
summary.stats["return", ] <- get.summary.stats(univariate.coeffs$stockret_lag1)
summary.stats["PE Ratio", ] <- get.summary.stats(univariate.coeffs$pe_lag1)
summary.stats["GDP", ] <- get.summary.stats(univariate.coeffs$gdp_pc1)
summary.stats["ROE", ] <- get.summary.stats(univariate.coeffs$roe_lag1)
summary.stats["Unemployment", ] <- get.summary.stats(univariate.coeffs$unemployment)
summary.stats["Inflation (PPI)", ] <- get.summary.stats(univariate.coeffs$ppipct)
summary.stats["Sales", ] <- get.summary.stats(univariate.coeffs$logsale_lag1)
summary.stats["AR", ] <- get.summary.stats(univariate.coeffs$logrect_lag1)
summary.stats["AP", ] <- get.summary.stats(univariate.coeffs$logap_lag1)
summary.stats["Delta Sales", ] <- get.summary.stats(univariate.coeffs$chgsale_lag1)
summary.stats["Delta AR", ] <- get.summary.stats(univariate.coeffs$chgrect_lag1)
summary.stats["Delta AP", ] <- get.summary.stats(univariate.coeffs$chgap_lag1)
summary.stats.xtable <- xtable(summary.stats, digits=4, caption=".", label="univariate-stats-eps")
print(summary.stats.xtable, type="latex", file="../tables/univariate-stats-eps.tex")
## Create summary stats of univariate R-Squared
summary.stats <- data.frame(matrix(NA, nrow=0, ncol=5))
names(summary.stats) <- c("mean","med","min","max","stdev")
summary.stats["EPS_{t-1}", ] <- get.summary.stats(univariate.rsquared$actual_lag1)
summary.stats["Total Assets", ] <- get.summary.stats(univariate.rsquared$totalassets_lag1)
summary.stats["Log Assets", ] <- get.summary.stats(univariate.rsquared$logtotalassets_lag1)
summary.stats["Accruals", ] <- get.summary.stats(univariate.rsquared$acc_lag1)
summary.stats["Dividends", ] <- get.summary.stats(univariate.rsquared$dividends_lag1)
summary.stats["Negative Earnings", ] <- get.summary.stats(univariate.rsquared$neg_actual_lag1)
summary.stats["Delta Price", ] <- get.summary.stats(univariate.rsquared$stockprcchg)
summary.stats["return", ] <- get.summary.stats(univariate.rsquared$stockret_lag1)
summary.stats["PE Ratio", ] <- get.summary.stats(univariate.rsquared$pe_lag1)
summary.stats["GDP", ] <- get.summary.stats(univariate.rsquared$gdp_pc1)
summary.stats["ROE", ] <- get.summary.stats(univariate.rsquared$roe_lag1)
summary.stats["Unemployment", ] <- get.summary.stats(univariate.rsquared$unemployment)
summary.stats["Inflation (PPI)", ] <- get.summary.stats(univariate.rsquared$ppipct)
summary.stats["Sales", ] <- get.summary.stats(univariate.rsquared$logsale_lag1)
summary.stats["AR", ] <- get.summary.stats(univariate.rsquared$logrect_lag1)
summary.stats["AP", ] <- get.summary.stats(univariate.rsquared$logap_lag1)
summary.stats["Delta Sales", ] <- get.summary.stats(univariate.rsquared$chgsale_lag1)
summary.stats["Delta AR", ] <- get.summary.stats(univariate.rsquared$chgrect_lag1)
summary.stats["Delta AP", ] <- get.summary.stats(univariate.rsquared$chgap_lag1)
summary.stats.xtable <- xtable(summary.stats, digits=4, caption=".", label="univariate-stats-eps-rsquared")
print(summary.stats.xtable, type="latex", file="../tables/univariate-stats-eps-rsquared.tex")
###################################################################################################
# Bivariate R-squared
###################################################################################################
univariate.rsquared <- data.frame(matrix(NA, nrow=0, ncol=length(indep.variables)))
names(univariate.rsquared) <- indep.variables
i <- 1
while(i <= n.firms){
current.ticker <- firms[i]
current.firm <- X[which(X$tic==current.ticker), ]
current.firm.train <- current.firm[which(current.firm$fyear < max(current.firm$fyear)), ]
current.firm.test <- current.firm[which(current.firm$fyear == max(current.firm$fyear)), ]
m.actual_lag1 <- tryCatch(summary(lm(actual ~ actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.totalassets <- tryCatch(summary(lm(actual ~ actual_lag1 + totalassets_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.logtotalassets <- tryCatch(summary(lm(actual ~ actual_lag1 + logtotalassets_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.acc <- tryCatch(summary(lm(actual ~ actual_lag1 + acc_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.dividends <- tryCatch(summary(lm(actual ~ actual_lag1 + dividends_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.neg_actual <- tryCatch(summary(lm(actual ~ actual_lag1 + neg_actual_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.stockprcchg <- tryCatch(summary(lm(actual ~ actual_lag1 + stockprcchg, data=current.firm.train))$r.squared, error = function(e) NA)
m.stockret <- tryCatch(summary(lm(actual ~ actual_lag1 + stockret_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.gdp <- tryCatch(summary(lm(actual ~ actual_lag1 + gdp_pc1, data=current.firm.train))$r.squared, error=function(e) NA)
m.roe <- tryCatch(summary(lm(actual ~ actual_lag1 + roe_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.unemployment <- tryCatch(summary(lm(actual ~ actual_lag1 + unemployment, data=current.firm.train))$r.squared, error = function(e) NA)
m.ppi <- tryCatch(summary(lm(actual ~ actual_lag1 + ppipct, data=current.firm.train))$r.squared, error = function(e) NA)
m.pe <- tryCatch(summary(lm(actual ~ actual_lag1 + pe_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.sale <- tryCatch(summary(lm(actual ~ actual_lag1 + logsale_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.rect <- tryCatch(summary(lm(actual ~ actual_lag1 + logrect_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.ap <- tryCatch(summary(lm(actual ~ actual_lag1 + logap_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgsale <- tryCatch(summary(lm(actual ~ actual_lag1 + chgsale_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgrect <- tryCatch(summary(lm(actual ~ actual_lag1 + chgrect_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
m.chgap <- tryCatch(summary(lm(actual ~ actual_lag1 + chgap_lag1, data=current.firm.train))$r.squared, error = function(e) NA)
univariate.rsquared[current.ticker, c("actual_lag1",
"totalassets_lag1",
"logtotalassets_lag1",
"acc_lag1",
"dividends_lag1",
"neg_actual_lag1",
"stockprcchg",
"stockret_lag1",
"gdp_pc1",
"roe_lag1",
"unemployment",
"ppipct",
"logsale_lag1",
"logrect_lag1",
"logap_lag1",
"chgsale_lag1",
"chgrect_lag1",
"chgap_lag1",
"pe_lag1")] <- c(m.actual_lag1, m.totalassets, m.logtotalassets, m.acc, m.dividends,
m.neg_actual, m.stockprcchg, m.stockret, m.gdp, m.roe,
m.unemployment, m.ppi, m.sale, m.rect, m.ap, m.chgsale, m.chgrect, m.chgap, m.pe)
i <- i+1
}
## Create summary stats of univariate R-Squared
summary.stats <- data.frame(matrix(NA, nrow=0, ncol=5))
names(summary.stats) <- c("mean","med","min","max","stdev")
summary.stats["EPS_{t-1}", ] <- get.summary.stats(univariate.rsquared$actual_lag1)
summary.stats["Total Assets", ] <- get.summary.stats(univariate.rsquared$totalassets_lag1)
summary.stats["Log Assets", ] <- get.summary.stats(univariate.rsquared$logtotalassets_lag1)
summary.stats["Accruals", ] <- get.summary.stats(univariate.rsquared$acc_lag1)
summary.stats["Dividends", ] <- get.summary.stats(univariate.rsquared$dividends_lag1)
summary.stats["Negative Earnings", ] <- get.summary.stats(univariate.rsquared$neg_actual_lag1)
summary.stats["Delta Price", ] <- get.summary.stats(univariate.rsquared$stockprcchg)
summary.stats["return", ] <- get.summary.stats(univariate.rsquared$stockret_lag1)
summary.stats["PE Ratio", ] <- get.summary.stats(univariate.rsquared$pe_lag1)
summary.stats["GDP", ] <- get.summary.stats(univariate.rsquared$gdp_pc1)
summary.stats["ROE", ] <- get.summary.stats(univariate.rsquared$roe_lag1)
summary.stats["Unemployment", ] <- get.summary.stats(univariate.rsquared$unemployment)
summary.stats["Inflation (PPI)", ] <- get.summary.stats(univariate.rsquared$ppipct)
summary.stats["Sales", ] <- get.summary.stats(univariate.rsquared$logsale_lag1)
summary.stats["AR", ] <- get.summary.stats(univariate.rsquared$logrect_lag1)
summary.stats["AP", ] <- get.summary.stats(univariate.rsquared$logap_lag1)
summary.stats["Delta Sales", ] <- get.summary.stats(univariate.rsquared$chgsale_lag1)
summary.stats["Delta AR", ] <- get.summary.stats(univariate.rsquared$chgrect_lag1)
summary.stats["Delta AP", ] <- get.summary.stats(univariate.rsquared$chgap_lag1)
summary.stats.xtable <- xtable(summary.stats, digits=4, caption=".", label="univariate-stats-eps-rsquared")
print(summary.stats.xtable, type="latex", file="../tables/univariate-stats-eps-rsquared.tex")
